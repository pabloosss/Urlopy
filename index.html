<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>System Urlopowy</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 30px; text-align: center; }
    .container { max-width: 600px; background: white; padding: 30px; border-radius: 10px; margin: auto; box-shadow: 0 0 10px rgba(0,0,0,0.2); }
    input, select { width: 100%; padding: 10px; margin: 10px 0; }
    button { padding: 10px 20px; }
    .link { margin-top: 20px; display: block; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Wniosek urlopowy</h2>
    <label for="nazwisko">Imię i nazwisko:</label>
    <input type="text" id="nazwisko" placeholder="Wpisz nazwisko..." oninput="filtrujNazwiska()">
    <div id="podpowiedzi"></div>

    <label for="od">Data od:</label>
    <input type="date" id="od">

    <label for="do">Data do:</label>
    <input type="date" id="do">

    <button onclick="zlozWniosek()">Złóż wniosek</button>
    <p id="info"></p>
    <a class="link" href="kadry.html">Przejdź do kadr</a>
  </div>

  <script>
    let pracownicy = JSON.parse(localStorage.getItem("pracownicy")) || [];

    function filtrujNazwiska() {
      const input = document.getElementById("nazwisko").value.toLowerCase();
      const podpowiedzi = pracownicy.filter(p => p.imie.toLowerCase().includes(input));
      document.getElementById("podpowiedzi").innerHTML = podpowiedzi.map(p => `<div onclick="uzupelnij('${p.imie}')">${p.imie}</div>`).join('');
    }

    function uzupelnij(imie) {
      document.getElementById("nazwisko").value = imie;
      document.getElementById("podpowiedzi").innerHTML = "";
    }

    function zlozWniosek() {
      const nazwisko = document.getElementById("nazwisko").value;
      const dataOd = document.getElementById("od").value;
      const dataDo = document.getElementById("do").value;

      if (!nazwisko || !dataOd || !dataDo) {
        document.getElementById("info").innerText = "Wypełnij wszystkie pola.";
        return;
      }

      const dniUrlopu = Math.ceil((new Date(dataDo) - new Date(dataOd)) / (1000 * 60 * 60 * 24)) + 1;
      const wnioski = JSON.parse(localStorage.getItem("wnioski")) || [];
      wnioski.push({ nazwisko, dataOd, dataDo, dni: dniUrlopu });
      localStorage.setItem("wnioski", JSON.stringify(wnioski));

      document.getElementById("info").innerText = "✅ Wniosek zapisany.";
      document.getElementById("nazwisko").value = "";
      document.getElementById("od").value = "";
      document.getElementById("do").value = "";
    }
  </script>
</body>
</html>
