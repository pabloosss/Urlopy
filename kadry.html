<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Kadry</title>
  <style>
    body { font-family: Arial; padding: 20px; max-width: 1000px; margin: auto; }
    h2 { margin-top: 30px; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    input, select, button { padding: 8px; margin: 5px 0; }
  </style>
</head>
<body>
  <h2>Kadry - panel menedżera</h2>
  <button onclick="wyloguj()">Wyloguj</button>
  <div id="panel"></div>

  <script>
    const zalogowany = JSON.parse(localStorage.getItem('menedzerZalogowany'));
    if (!zalogowany) {
      alert('Brak dostępu. Zaloguj się jako menedżer.');
      location.href = 'kadry_login.html';
    }

    const wszyscy = JSON.parse(localStorage.getItem('pracownicy')) || [];
    const wnioski = JSON.parse(localStorage.getItem('wnioski')) || [];

    const przypisani = zalogowany.imie === 'ADMIN'
      ? wszyscy
      : wszyscy.filter(p => p.menadzer === zalogowany.imie);

    const przypisaneWnioski = zalogowany.imie === 'ADMIN'
      ? wnioski
      : wnioski.filter(w => przypisani.find(p => p.imie === w.imie));

    let html = '<h3>Lista pracowników</h3>';
    html += '<table><tr><th>Imię i nazwisko</th><th>Menedżer</th></tr>';
    przypisani.forEach(p => {
      html += `<tr><td>${p.imie}</td><td>${p.menadzer}</td></tr>`;
    });
    html += '</table>';

    html += '<h3>Wnioski urlopowe</h3>';
    html += '<table><tr><th>Pracownik</th><th>Od</th><th>Do</th><th>Status</th></tr>';
    przypisaneWnioski.forEach(w => {
      html += `<tr><td>${w.imie}</td><td>${w.od}</td><td>${w.do}</td><td>${w.status}</td></tr>`;
    });
    html += '</table>';

    document.getElementById('panel').innerHTML = html;

    function wyloguj() {
      localStorage.removeItem('menedzerZalogowany');
      location.href = 'kadry_login.html';
    }
  </script>
</body>
</html>
